<div class="container">
  <h2 class="text-center p-3">投稿詳細</h2>
  <div class="row">
      <%= attachment_image_tag @post, :image,size: "300x300", class: "offset-2 col-4" %>
    <div class="col-6">
      <p><%= @post.user.name %></p>
      <p>title: <%= @post.title %></p>
      <p>content: <%= @post.content %></p>
      <p>コメント数: <%= @post.post_comments.count %></p>
      <p><%= render "favorites/favorites", post: @post %></p>
      <p>投稿日: <%= @post.created_at.strftime('%Y/%m/%d') %></p>
      <% if @post.user == current_user %>
        <%= link_to "編集", edit_post_path(@post), class: "btn btn-primary btn-sm" %>
        <%= link_to "削除", post_path(@post), method: :delete,"data-confirm" => "本当に削除しますか？", class: "btn btn-danger btn-sm" %>
      <% end %>
    </div>
  </div>
</div>

<div class="container mt-5">
  <div class="row">
    <h3 class="offset-2 col-4">コメント欄</h3>
    <h3 class="offset-2 col-4">いいねした会員</h3>
  </div>
  <div class="row">
    <div class="offset-2 col-4">
      <%= form_with(model:[@post, @comment], local: true) do |f| %>
        <%= render "layouts/errors", obj: @comment %>
        <p>
          <%= f.text_area :comment, rows:"2", placeholder: "コメント入力欄" %>
          <%= f.submit "コメント", class: "btn btn-success btn-sm" %>
        </p>
      <% end %>
      <% @post.post_comments.reverse.each do |post_comment| %>
        <div class="row">
          <div class="flex-column">
            <div><%= attachment_image_tag post_comment.user, :profile_image, size: "50x50", format: 'jpeg', fallback: "no_image.jpg"%></div>
            <p class="text-center"><%= link_to post_comment.user.name, user_path(post_comment.user) %></p>
          </div>
          <div class="offset-1 mt-3">
            <%= post_comment.comment %>
            <% if post_comment.user == current_user %>
              <%= link_to "削除", post_post_comment_path(post_comment.post, post_comment), method: :delete %>
            <% end %>
          </div>
        </div>
      <% end %>
    </div>
    <div class="col-4 offset-2">
      <table calss="table">
        <% @favorites.each do |favorite| %>
          <tbody>
            <td><%= attachment_image_tag favorite.user, :profile_image, size: "50x50", format: 'jpeg', fallback: "no_image.jpg" %></td>
            <td class="pl-3"><%= link_to favorite.user.name, user_path(favorite.user) %></td>
          </tbody>
        <% end %>
      </table>
    </div>
  </div>
</div>
